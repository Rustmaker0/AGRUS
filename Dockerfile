# Используем официальный и актуальный образ Node.js
FROM node:20-slim

# Создаем рабочую директорию внутри контейнера
WORKDIR /app

# Копируем файлы с описанием зависимостей (используем .dockerignore, чтобы не копировать лишнее)
COPY package*.json ./

# Устанавливаем зависимости. Флаг --only=production ставит только нужное для работы.
# npm ci обеспечивает более чистую и быструю установку по lock-файлу.
RUN npm ci --only=production

# Копируем остальной код приложения
COPY . .

# Указываем, какой порт будет слушать приложение (для документации)
EXPOSE 3000

# Команда для запуска приложения
CMD ["node", "server.js"]